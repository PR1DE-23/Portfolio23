---
import ProjectCard from "./ProjectCard.astro";

import { ChevronLeft, ChevronRight } from "@lucide/astro";


const projects = [

{ title: "Plataforma Integral de Comercio Electrónico para Artesanos", description: "Una tienda virtual moderna que permite a pequeños productores gestionar inventarios, procesar pagos seguros y conectar con clientes globales.", image: "/p1.jpeg" },

{ title: "Gestor de Tareas Colaborativo para Equipos Remotos", description: "Aplicación web de flujos que permite a equipos gestionar tareas, asignar responsabilidades y monitorear progreso.", image: "/p2.jpeg" },

{ title: "Portal Web de Salud y Seguimiento Nutricional de Gestión de Inventario para Artesanos", description: "Portal Salud y Nutrición que ofrece información sobre nutrición, dietas, y herramientas para monitorear el progreso de los usuarios.", image: "/p3.jpeg" },

{ title: "Red Social para Amantes de los Viajes", description: "Red Social Viajeros que permite a usuarios compartir experiencias, planificar viajes y obtener recomendaciones.", image: "/p4.jpeg" },

{ title: "Plataforma de Cursos Online con Sistema Gamificado", description: "Entorno educativo gamificado que ofrece lecciones en video, exámenes interactivos y un sistema de recompensas para motivar el aprendizaje continuo.", image: "/p5.jpeg" },

];
---

<div class="relative w-full max-w-5xl mx-auto overflow-hidden group">
  <div 
    id="carousel-track"
    class="flex transition-transform duration-500 ease-out w-full"
  >
    {projects.map((project) => (
      <div class="w-full flex-shrink-0">
        <ProjectCard {...project} />
      </div>
    ))}
  </div>

  <!-- Navigation -->
  <div class="flex justify-center gap-4 mt-8">
    <button id="prev-btn" class="p-3 rounded-full border border-subtle hover:bg-focus/10 text-fg">
      <ChevronLeft class="size-6" />
    </button>

    <div class="flex items-center gap-3">
      {projects.map((_, i) => (
        <button data-index={i} class="dot size-3 rounded-full bg-subtle/30 transition-all duration-300 "></button>
      ))}
    </div>
    
    <button id="next-btn" class="p-3 rounded-full border border-subtle hover:bg-focus/10 text-fg">
      <ChevronRight class="size-6" />  
    </button> 
  </div>
</div>

<script>
  const track = document.getElementById("carousel-track");
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");
  const dots = document.querySelectorAll(".dot");

  let currentIndex = 0;
  const totalSlides = dots.length;

  const updateCarousel = () => {
    if(track) {
      track.style.transform = `translateX(-${currentIndex * 100}%)`;
    }

    dots.forEach((dot, i) => {
      dot.classList.toggle("bg-focus", i === currentIndex);
      dot.classList.toggle("scale-125", i === currentIndex);
      dot.classList.toggle("bg-subtle/30", i !== currentIndex);
    })
  }

  nextBtn?.addEventListener('click', () => {
    currentIndex = (currentIndex + 1) % totalSlides;
    updateCarousel();
  });

  prevBtn?.addEventListener('click', () => {
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateCarousel();
  });

  // 5. Permitir clic directo en los puntos
  dots.forEach((dot, i) => {
    dot.addEventListener('click', () => {
      currentIndex = i;
      updateCarousel();
    });
  });

  // Ejecución inicial para marcar el primer punto como activo
  updateCarousel();
</script>