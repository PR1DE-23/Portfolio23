---
  import { TextAlignJustify, Facebook, Linkedin, X, Github } from '@lucide/astro';
---

<div class="container mt-4">
<header class="relative flex justify-between items-center h-[56px] bg-fg text-bg text-lg rounded-xl font-bold">


  <a href="/" class="flex items-center ml-3 gap-2 hover:text-focus hover:translate-x-2 transition-all duration-200 cursor-pointer">
    <svg class="w-[1.7rem] h-[1.7rem]">
      <use href="/icons/sprites.svg#devil.oper"></use>
    </svg>
    <span>Devil.Oper</span>  
  </a>
    
  <nav class="md:absolute hidden sm:flex md:left-1/2 md:-translate-x-1/2">
    <ul class="flex w-full justify-between gap-12">
      <li class="group relative py-2 transition-all duration-200">
        <a href="/about">About me</a>
        <span class="absolute bottom-2 right-0 h-1 w-full bg-focus origin-right scale-x-0 transition-all duration-200 group-hover:scale-x-100"></span>
      </li>
      <li class="group relative py-2 transition-all duration-200">
        <a href="/projects">Projects</a>
        <span class="absolute bottom-2 right-0 h-1 w-full bg-focus origin-right scale-x-0 transition-all duration-200 group-hover:scale-x-100"></span>
      </li>
      <li class="group relative py-2 transition-all duration-200">
        <a href="/contact">Contact</a>
        <span class="absolute bottom-2 right-0 h-1 w-full bg-focus origin-right scale-x-0 transition-all duration-200 group-hover:scale-x-100"></span>
      </li>
    </ul>
  </nav>

  <button class="hidden bg-bg hover:bg-focus transition-colors duration-200 text-fg text-center font-bold rounded-md w-10 h-10 sm:flex items-center justify-center mr-2">Es</button>

  <button id="menu-btn" class="group w-10 h-10 flex items-center mr-2 justify-center relative sm:hidden rounded-md hover:bg-focus/10 transition-colors duration-200" aria-expanded="false">
    <TextAlignJustify class="absolute inset-0 m-auto w-6 h-6 transition-all duration-300 ease-in-out group-[.open]:opacity-0 group-[.open]:rotate-90"/>
    <X class="absolute inset-0 m-auto w-6 h-6 transition-all duration-300 ease-in-out opacity-0 -rotate-90 group-[.open]:opacity-100 group-[.open]:rotate-90"/>
  </button>

  <div 
    id="menu" 
    class="absolute top-[56px] right-0 w-full bg-bg border-b border-subtle sm:hidden opacity-0 invisible -translate-y-2 pointer-events-none transition-all duration-300 ease-in-out [&.open]:opacity-100 [&.open]:visible [&.open]:translate-y-0 [&.open]:pointer-events-auto" 
  >
    <ul class="flex flex-col divide-y divide-subtle">
      <li class="text-end hover:bg-focus/10 cursor-pointer transition-colors duration-200">
        <a href="/about" class="block size-full p-5">About</a>
      </li>
      <li class="text-end hover:bg-focus/10 cursor-pointer transition-colors duration-200">
        <a href="/projects" class="block size-full p-5">Projects</a>
      </li>
      <li class="text-end hover:bg-focus/10 cursor-pointer transition-colors duration-200">
        <a href="/contact" class="block size-full p-5">Contact</a>
      </li>
    </ul>
  </div>
  
</header>
</div>

<script>
  const btn = document.getElementById('menu-btn');
  const menu = document.getElementById('menu');


  const closeMenu = () => {
    btn?.classList.remove('open');
    menu?.classList.remove('open');
    btn?.setAttribute('aria-expanded', 'false');
  }

  btn?.addEventListener('click', (e) => {
    e.stopPropagation();

    btn?.classList.toggle('open');
    menu?.classList.toggle('open');

    const isOpen = btn?.classList.contains('open');
    btn?.setAttribute('aria-expanded', String(isOpen));
  });

  document.addEventListener('click', (event) => {
    const target = event.target as Node;
    const isClickInsideMenu = menu?.contains(target);
    const isClickBtnButton = btn?.contains(target);
    
    if (!isClickInsideMenu && !isClickBtnButton && btn?.classList.contains('open')) {
      closeMenu();
    }
  });

  menu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      closeMenu();
    });
  });
</script>