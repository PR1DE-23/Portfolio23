---
import { Moon, Sun } from "@lucide/astro";
---

<button
  id="theme-toggle"
  class="relative hidden md:flex h-8 w-14 items-center border border-acent rounded-full p-1 transition-colors duration-300"
>
  <Sun class="absolute left-2" size="16" />
  <Moon class="absolute right-2" size="16" />
  <span
    id="toggle-ball"
    class="absolute w-6 h-6 rounded-full bg-acent transition-transform duration-300 translate-x-0 dark:translate-x-6"
  ></span>
</button>

<script>
  const getInitialTheme = () => {
    const stored = localStorage.getItem("theme");
    if (stored) return stored === "dark";

    return window.matchMedia("(prefers-color-scheme: dark)").matches;
  };

  const applyTheme = (isDark) => {
    if (isDark) {
      document.documentElement.classList.add("dark");
      localStorage.setItem("theme", "dark");
    } else {
      document.documentElement.classList.remove("dark");
      localStorage.setItem("theme", "light");
    }
  };

  let isDarkMode = getInitialTheme();
  applyTheme(isDarkMode);

  const button = document.getElementById("theme-toggle");
  button.addEventListener("click", () => {
    isDarkMode = !isDarkMode;
    applyTheme(isDarkMode);
  });
</script>